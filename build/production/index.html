<!DOCTYPE html>
<html lang="zh-CN">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<meta content="yes" name="apple-mobile-web-app-capable">
	<meta content="black" name="apple-mobile-web-app-status-bar-style">
	<meta name="format-detection" content="telephone=no, email=no" />
	<meta http-equiv="X-UA-Compatible" content="IE=Edge">
	<meta name="renderer" content="webkit">
	<meta name="browsermode" content="application">
	<meta name="x5-page-mode" content="app">
	<title ng-bind="title"></title>
	<base href="/">
	<!-- <link rel="stylesheet" type="text/css" href="libs/weui/dist/style/weui.min.css"> -->
	<link rel="stylesheet" type="text/css" href="statics/styles/app.css">
</head>
<body ng-controller="init">
<!--[if lte IE8]>
<p class="browserupgrade">您的浏览器版本老旧,请到 <a href="http://browsehappy.com">这里</a> 更新,以获取最佳体验</p>
<![endif]-->
<div id="loading" ng-hide="loaded">
	<div class="cycle-in"></div>
	<div class="cycle-out"></div>
	<div class="rate">0%</div>
	<div class="msg">loading...</div>
</div>
<div ui-view class="container" id="container"></div>

<script>
var G = G || {};
G.version = '1.0.0';
G.links = [
    'libs/weui/dist/style/weui.min.css'
];
G.scripts = [
	"libs/jquery/jquery/dist/jquery.js",
    "libs/angular/angular/angular.js",
    "libs/angular/angular-animate/angular-animate.js",
    "libs/angular/angular-ui-router/release/angular-ui-router.js",
    "libs/angular/oclazyload/dist/ocLazyLoad.js",
    "statics/js/app.js",
    "statics/js/app.config.js",
    "statics/js/app.config.lazyload.js",
    "statics/js/app.config.router.js",
    "statics/js/directives/img-verify.js",
    "statics/js/main.js"



	// "libs/jquery/jquery/dist/jquery.min.js",
 //    "libs/angular/angular/angular.min.js",
 //    "libs/angular/angular-animate/angular-animate.min.js",
 //    "libs/angular/angular-ui-router/release/angular-ui-router.min.js",
 //    "libs/angular/oclazyload/dist/ocLazyLoad.min.js",
 //    "statics/js/app.js",
 //    "statics/js/app.config.js",
 //    "statics/js/app.config.lazyload.js",
 //    "statics/js/app.config.router.js",
 //    "statics/js/directives/img-verify.js",
 //    "statics/js/main.js"
];
document.addEventListener('DOMContentLoaded', function(){
    var files = [];
    var ext = '?v='+G.version;
    for(var i in G.links){
        files.push({src:G.links[i] + ext,type:'css'});
    }
    for(var i in G.scripts){
        files.push({src:G.scripts[i] + ext,type:'js'});
    }
    var total = files.length;//待加载的文件总数
    var loadedNum = 0;//已加载的文件数
    var elRate = document.querySelector('#loading .rate');//显示加载比率的元素
    var head = document.getElementsByTagName('head')[0];
    //立即执行的闭包递归加载
    (function(files){
        if(files.length == 0)return false;
        var file = files.shift();
        var el;
        if(file.type == 'js'){
            el = document.createElement('script');
            el.type = 'text/javascript';
            el.src = file.src;
        }else{
            el = document.createElement('link');
            el.type = 'text/css';
            el.rel = 'stylesheet';
            el.href = file.src;
        }
        fn = arguments.callee;
        (function(el, files){
            el.onload = el.onreadystatechange = function(){
                if((!this.readyState || this.readyState === "loaded" || this.readyState === "complete")){
                    loadedNum++;
                    elRate.innerText = parseInt(loadedNum/total*100) + '%';
                    //console.log('加载完毕:', this.src || this.href);
                    //加载下一个文件,这里实现了文件一个个顺序加载,上一个加载完成才会head.appendChild下一个元素
                    fn(files);
                    el.onload = el.onreadystatechange = null;//清除事件
                }
            }
        })(el, files);
        //如果用for循环来appendChild,这些append的新元素会并发的向服务器请求资源,这样有依赖关系的js就会报错
        head.appendChild( el );
    })(files);
}, false);
// (function(){
// 	var elRate = document.querySelector('#loading .rate');
// 	var rate = 0;
// 	var timer = setInterval(function(){
// 		rate++;
// 		if(rate >= 100){
// 			rate = 100;
// 			clearInterval(timer);
// 		}
//     	elRate.innerText = rate + '%';
// 	}, 100);
// 	document.addEventListener('DOMContentLoaded', function(){
// 		timer && clearInterval(timer);
// 		elRate.innerText = '100%';
// 	}, false);
// })();
</script>





<!-- <script type="text/javascript" src="libs/angular/angular/angular.min.js"></script>
<script type="text/javascript" src="libs/angular/angular-animate/angular-animate.min.js"></script>
<script type="text/javascript" src="libs/angular/angular-ui-router/release/angular-ui-router.min.js"></script>
<script type="text/javascript" src="libs/angular/oclazyload/dist/ocLazyLoad.min.js"></script>
<script type="text/javascript" src="libs/jquery/jquery/dist/jquery.min.js"></script>

<script type="text/javascript" src="statics/js/app.js"></script>
<script type="text/javascript" src="statics/js/app.config.js"></script>
<script type="text/javascript" src="statics/js/app.config.lazyload.js"></script>
<script type="text/javascript" src="statics/js/app.config.router.js"></script>
<script type="text/javascript" src="statics/js/main.js"></script> -->

</body>
</html>